Klasse: 4AHITS   
Name: Sarah Krottenhammer   
Fach: ITSE    
Datum: 17.11.2025   

# Thema: Port probing und scanning
## Übung 3: nmap port scan
**Angabe:**  
Nach dem ping scan (und wenn nicht die Option -sn angegeben ist) führt nmap automatisch einen port scan auf allen gefundenen hosts aus. Dabei wird versucht alle offenen Ports eines Hosts zu finden. Das Ziel ist eine Liste der am Host laufenden Dienste zu erhalten.

Hinweise: Man kann eine einzelne IP Adresse angeben, dann wird nur diese gescannt, z.B.: nmap 192.168.178.42

Siehe List of TCP and UDP port numbers

Aufgaben:
- Führe einen port scan auf die Metasploitable VM durch. Analysiere das Ergebnis.
- Experimentiere mit den Optionen für (Victim ist Metasploitable VM):
  - Scannen aller möglichen Ports. Macht das bei Metasploitable, verglichen zum Default Verhalten, einen Unterschied?
  - Überspringen Ping-Scan/Host-Discovery. Warum kann diese Option notwendig sein?
  - Service/Version Detection
  - OS Erkennung
  - Aggressive Scan
  - Timing/Speed
  - Ausgabe in Dateien
  - die Option --reason
  - nur die N häufigsten Ports scannen (dokumentiere den Geschwindigkeitsgewinn)
- Führe weitere port scans durch, auf:
  - einem Kali Linux auf einem anderen Rechner
  - einem Windows System
  - dem Default Gateway im Labor Netz
- Was kann alles mit einem port scan herausgefunden werden? Dokumentiere!

### 1. Führe einen port scan auf die Metasploitable VM durch. Analysiere das Ergebnis.
Befehl: `nmap 192.168.17.51`   
Der Befehl prüft, ob das Ziel erreichbar ist. Wenn der Host als „up“ gemeldet wird, führt nmap den Portscan aus.   
![](https://github.com/user-attachments/assets/85ee0563-6150-49c6-b241-716339b37bd7)   

Analyse: Der Befehl führt Host-discovery durch, um zu prüfen, ob der Host up oder down ist. Dabei gibt er eine Zusammenfassung der gefundnen offenen Ports und der vermuteten Dienstbezeichnung aus, wenn der Port offen ist. Dann wird ein port-Scan der Top-1000 TCP-Ports ausgeführt.

### 2. Experimentiere mit den Optionen
#### Scannen aller möglichen Ports. Macht das bei Metasploitable, verglichen zum Default Verhalten, einen Unterschied?    
Dies ist mit der Option `-p-` möglich.   
![](https://github.com/user-attachments/assets/fa48c66f-e34b-4cd0-8b64-6914197c2fd0)

Mit der Option `-p-`werden alle 65.535 TCP-Ports gescannt statt der standardmäßig gescannten Top-1000.   
Das kann bei Metasploitable einen Unterschied machen, weil dort oft Dienste auf hohen, untypischen Ports laufen, die der Default-Scan überspringt.

#### Überspringen Ping-Scan/Host-Discovery. Warum kann diese Option notwendig sein?
Dies ist mit der Option `-Pn` möglich.    
![](https://github.com/user-attachments/assets/76544032-04d6-4de4-a5cc-b34df5b2df46)   
Mit der Option `-Pn` wird Ping-Scan/Host-Discovery übersprungen und der Portscan wird in jedem Fall durchgeführt.
Dies ist notwendig in Umgebungen, in denen Ping- oder Discovery-Pakete gefiltert werden, z. B. in Firewalls   
Ohne `-Pn` könnte nmap den Host fälschlich als „down“ melden, obwohl er hochgefahren ist.

#### Service/Version Detection
Dies ist mit der Option `-sV` möglich.   
 ![](https://github.com/user-attachments/assets/c53ce6f9-3f6e-49a3-bb78-520f1a4bcc0e)   
 Mit der Option `-sV` führt nmap einen Dienst- und Versionsscan der offenen Ports durch. Dadurch erhält man nicht nur die Information, welche Ports offen sind, sondern auch welcher Dienst dahinter läuft und meist die genaue Version.

#### OS Erkennung
Dies ist mit der Option `-O` möglich.   
![](https://github.com/user-attachments/assets/db531291-2a24-409a-b314-2b85155f0771)    
Betriebssystem: Linux 2.6.9 - 2.6.33   
Mit der Option `-O` versucht nmap, das Betriebssystem des Zielsystems zu bestimmen.   

####  Aggressive Scan
Dies ist mit der Option `-A` möglich.   
Kombiniert mehrere Techniken in einem Durchlauf:   
- `-sV` (Service-Versionen)
- `-O` (OS-Detection)
- Script Scans
- Traceroute

#### Timing/Speed
Die Timing-Optionen steuern die Scan-Geschwindigkeit und Aggressivität.    
Option:   
`-T0`  bis `-T5`   

Beispiel mit der Option `-T4`:   
![](https://github.com/user-attachments/assets/af502cc2-952c-490d-beca-46e0a7975253)   

Schnelligkeit der Optionen:   
- `-T0` sehr langsam 
- `-T3` Default
- `-T4` schneller 
- `-T5` maximal schnell (unzuverlässig + laut)

#### Ausgabe in Dateien
nmap kann seine Ergebnisse in verschiedenen Formaten speichern. Diese Optionen heißen:   
- `-oN` → normale Textausgabe
- `-oG` → „grepable“ Format
- `-oX` → XML-Ausgabe
- `-oA` → alle drei Formate gleichzeitig

Man muss nach der Option immer den Namen der Zieldatei angeben.      

Beispiel: Normale Textausgabe   
Speichert die „normale“ Terminalausgabe 1:1 in eine Datei.   
Befehl: `nmap -oN scan.txt  192.168.17.51`   
Inhalt wird in die Textdatei scan.txt gespeichert.   
Datei scan.txt:   
![](https://github.com/user-attachments/assets/612cb021-4235-40e6-b8fc-75855d9241cb)

#### die Option --reason
Nmap zeigt nicht nur den Status eines Ports (open, closed, filtered), sondern auch den Grund für diese Einstufung.   
![](https://github.com/user-attachments/assets/1babcab0-b956-4538-af2c-0fde0b7395c4)

#### nur die N häufigsten Ports scannen (dokumentiere den Geschwindigkeitsgewinn)
Option: `--top-ports <N>`      
N ist die Anzahl der häufigsten Ports   

![](https://github.com/user-attachments/assets/498e4918-05fb-4a90-8245-f2ed82965787)


### 3. Führe weitere port scans durch.
#### Auf einem Kali Linux auf einem anderen Rechner
PortScan wird auf das Kali Linux im Labornetz 5 durchgeführt.   
PortScan wurde auf die Ports 1-50 eingeschränkt, da es sonst ewig lädt.   

![](https://github.com/user-attachments/assets/0cadf23f-a7b1-4a01-a6e2-5217148cbe4e)   


#### Auf einem Windows System
PortScan auf mein Windows-System 192.168.17.50   
![](https://github.com/user-attachments/assets/a03e2de3-d755-4c79-ab4e-25918c816a52)

#### Auf dem Default Gateway im Labor Netz
Default-Gateway: 192.168.17.254   
![](https://github.com/user-attachments/assets/af48d4c0-98fc-4dec-9021-379423e97145)

### 4. Was kann alles mit einem port scan herausgefunden werden? Dokumentiere!
<table>
  <thead>
    <tr>
      <th>Option / Scan</th>
      <th>Was es liefert</th>
      <th>Bemerkung / Nutzen</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>nmap &lt;IP&gt;</td>
      <td>Standard TCP-Scan der 1000 häufigsten Ports</td>
      <td>Zeigt offene Ports, grundlegende Dienste</td>
    </tr>
    <tr>
      <td>-p &lt;Ports&gt;</td>
      <td>Scan nur bestimmter Ports oder Portbereiche</td>
      <td>Geschwindigkeit kontrollieren, gezielt prüfen</td>
    </tr>
    <tr>
      <td>-p-</td>
      <td>Alle 65535 Ports scannen</td>
      <td>Vollständiger Scan, deutlich länger</td>
    </tr>
    <tr>
      <td>--top-ports N</td>
      <td>Nur die N häufigsten Ports</td>
      <td>Sehr schneller Scan</td>
    </tr>
    <tr>
      <td>-sn</td>
      <td>Ping-Scan / Host Discovery</td>
      <td>Prüft nur, ob Host online ist, kein Portscan</td>
    </tr>
    <tr>
      <td>-Pn</td>
      <td>Ping überspringen / erzwingt Portscan ohne Host-Discovery</td>
      <td>Nützlich bei Firewalls oder "ping blockiert"</td>
    </tr>
    <tr>
      <td>-sV</td>
      <td>Service-/Versionserkennung</td>
      <td>Erkennt, welcher Dienst auf welchem Port läuft und Versionsinformationen</td>
    </tr>
    <tr>
      <td>-O</td>
      <td>Betriebssystemerkennung</td>
      <td>Ermittelt OS und evtl. Version</td>
    </tr>
    <tr>
      <td>-A</td>
      <td>Aggressiver Scan (OS + Service/Version + Skripte)</td>
      <td>Alles-in-einem Scan, sehr detailliert</td>
    </tr>
    <tr>
      <td>-T&lt;0-5&gt;</td>
      <td>Timing / Geschwindigkeit</td>
      <td>Beeinflusst Scan-Dauer und Belastung, T0=sehr langsam, T5=sehr schnell</td>
    </tr>
    <tr>
      <td>-oN &lt;Datei&gt;</td>
      <td>Output in Datei</td>
      <td>Ergebnisse speichern für Dokumentation oder spätere Analyse</td>
    </tr>
    <tr>
      <td>--reason</td>
      <td>Zeigt Grund, warum Port als offen/geschlossen/filtered klassifiziert wurde</td>
      <td>Hilft Firewall-/Filteranalyse, Verständnis der Ergebnisse</td>
    </tr>
  </tbody>
</table>


## Übung 4: nmap cheat sheet
**Angabe:**  
Erstelle ein Cheat Sheet mit allen `nmap` Optionen die du verwendet hast und jenen die du für wichtig erachtest. Erstelle das cheat sheet so, dass es dir später als Nachschlagewerk dienen kann.

<table border="1" cellpadding="8" cellspacing="0">
  <thead>
    <tr>
      <th>Option / Scan</th>
      <th>Beschreibung</th>
      <th>Nutzen / Bemerkung</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>nmap &lt;IP&gt;</td>
      <td>Standard TCP-Scan der 1000 häufigsten Ports</td>
      <td>Zeigt offene Ports und grundlegende Dienste</td>
    </tr>
    <tr>
      <td>-p &lt;Ports&gt;</td>
      <td>Scan bestimmter Ports oder Portbereiche</td>
      <td>Gezielte Prüfung und Kontrolle der Geschwindigkeit</td>
    </tr>
    <tr>
      <td>-p-</td>
      <td>Alle 65535 TCP-Ports scannen</td>
      <td>Vollständiger Scan, länger, erkennt untypische Dienste</td>
    </tr>
    <tr>
      <td>--top-ports N</td>
      <td>Nur die N häufigsten Ports</td>
      <td>Sehr schneller Scan, ideal für Recon</td>
    </tr>
    <tr>
      <td>-sn</td>
      <td>Ping-Scan / Host Discovery</td>
      <td>Prüft nur, ob Host online ist, kein Portscan</td>
    </tr>
    <tr>
      <td>-Pn</td>
      <td>Ping überspringen / erzwingt Portscan ohne Host-Discovery</td>
      <td>Nützlich bei Firewalls oder Hosts, die Ping blockieren</td>
    </tr>
    <tr>
      <td>-sV</td>
      <td>Service-/Versionserkennung</td>
      <td>Erkennt, welcher Dienst auf welchem Port läuft, inkl. Version</td>
    </tr>
    <tr>
      <td>-O</td>
      <td>Betriebssystemerkennung</td>
      <td>Ermittelt das Betriebssystem des Zielhosts</td>
    </tr>
    <tr>
      <td>-A</td>
      <td>Aggressiver Scan (OS + Service/Version + Skripte)</td>
      <td>Alles-in-einem Scan, sehr detailliert</td>
    </tr>
    <tr>
      <td>-T0 bis -T5</td>
      <td>Timing / Geschwindigkeit</td>
      <td>Beeinflusst Scan-Dauer und Belastung: T0=sehr langsam, T5=sehr schnell</td>
    </tr>
    <tr>
      <td>-oN &lt;Datei&gt;</td>
      <td>Speichert Output in Datei (Normalformat)</td>
      <td>Ergebnisse dokumentieren oder später analysieren</td>
    </tr>
    <tr>
      <td>--reason</td>
      <td>Zeigt Grund, warum ein Port als offen/geschlossen/filtered markiert wurde</td>
      <td>Hilft beim Verständnis von Firewall- und Filterregeln</td>
    </tr>
    <tr>
      <td>-sS</td>
      <td>Scannt Ports sehr schnell und unauffällig, ohne eine vollständige TCP-Verbindung aufzubauen</td>
      <td>Effizient und von Firewalls/IDS oft schwerer zu erkennen.</td>
    </tr>
     <tr>
      <td>--sU</td>
      <td>Findet offene UDP-Ports wie DNS, DHCP, SNMP.</td>
      <td>UDP-Dienste werden oft übersehen, sind aber sehr sicherheitskritisch.</td>
    </tr>
  </tbody>
</table>

# Thema: Vulnerability Scanning
## Übung 1: Optionen
**Angabe:**  
Analysiere die Bedeutung der folgenden Optionen:   

```
$ nmap -Pn -sS -sV -sC -oN nmap_default.txt 10.10.92.153
```
Was führt nmap in diesem Fall für einen Scan aus? Wie viele Ports werden gescannt. Scanne mit diesem Befehl die metasploitable VM


<table border="1" cellpadding="8" cellspacing="0">
<thead>
<tr>
<th>Option</th>
<th>Bedeutung</th>
<th>Beispiel / Informationen</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-Pn</code></td>
<td>Überspringt Ping/Host-Discovery. Nmap geht davon aus, dass der Host erreichbar ist.</td>
<td>Praktisch, wenn ICMP/Ping blockiert wird</td>
</tr>
<tr>
<td><code>-sS</code></td>
<td>SYN-Scan („Half-Open“). Baut die TCP-Verbindung nicht vollständig auf, sehr schnell und unauffällig.</td>
<td>Scan der Top 1000 TCP-Ports der Metasploitable VM.</td>
</tr>
<tr>
<td><code>-sV</code></td>
<td>Service- und Versionsscan. Identifiziert Dienste und Versionsnummern hinter offenen Ports.</td>
<td>Beispiel: Apache 2.2.8, OpenSSH 4.7p1 auf Metasploitable.</td>
</tr>
<tr>
<td><code>-sC</code></td>
<td>Standard Nmap-Skript-Scan (NSE). Führt Standard-Skripte aus, z.B. Banner-Grabbing oder einfache Sicherheitschecks.</td>
<td>Zusätzliche Informationen über Dienste, z.B. Banner, SMB-Schwachstellen.</td>
</tr>
<tr>
<td><code>-oN nmap_default.txt</code></td>
<td>Speichert die Ausgabe im normalen Textformat in der angegebenen Datei.</td>
<td>Ergebnis wird in <code>nmap_default.txt</code> gespeichert.</td>
</tr>
<tr>
<td>&lt;IP&gt;</td>
<td>Zielhost der Untersuchung.</td>
<td>Beispiel: <code>192.168.17.51</code> für Metasploitable VM.</td>
</tr>
</tbody>
</table>

Was führt Nmap in diesem Fall aus?   
- Ignoriert Ping/Host-Discovery → scannt den Host auf jeden Fall (-Pn).
- SYN-Scan der Top 1000 TCP-Ports (-sS ist standardmäßig TCP).
- Identifiziert die Dienste und Versionsnummern der offenen Ports (-sV).
- Führt die Standard-Nmap-Skripte aus (-sC).
- Speichert die Ergebnisse in nmap_default.txt.

Standardmäßig scannt Nmap 1000 der am häufigsten verwendeten TCP-Ports, es sei denn, du gibst -p- oder --top-ports N an. Daher werden hier die 1000 der am häufigsten verwendeten TCP-Ports gescannt.    

Metasploitable scannen:   
```
nmap -Pn -sS -sV -sC -oN nmap_default.txt 192.168.17.51
```
