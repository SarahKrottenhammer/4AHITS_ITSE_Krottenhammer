Klasse: 4AHITS   
Name: Sarah Krottenhammer   
Fach: ITSE    
Datum: 15.12.2025   

# Thema: Vulnerability Scanning
## Übung 1: Optionen
wurde schon im vorherigen Bericht erledigt!

## Übung 2: vulnerability scan
**Angabe:**   
nmap verfügt über eine Erweiterung über die Lua Scripts ausgeführt werden können. Die installierten Lua Scripts befinden sich im Directory /usr/share/nmap/scripts.

Aufgabe 1: Verwende die Option -sC um die Standard-Skripte auszuführen, zusätzlich beschränkt auf die 100 häufigsten Ports (Option -F) aus.

Anmerkung: nmap kann wertvolle Hinweise auf Schwachstellen liefern, ein vollwertiger vulnerability scaner ist es allerdings nicht, dafür gibt es eigene darauf spezialisierte Tools (z.B.: gvm … Greenbone Vulnerability Manager).

Aufgabe 2: verwende die Option --script um ausgewählte Skripte zu starten. Z.B. --script http-title,mysql-info,banner. Probiere ca. 5 Skripte aus. Nimm die Metasploitable VM als Ziel.

Aufgabe 3: finde ein weiteres Skript das bei der Metasploitable VM sinnvolle Ergebnisse liefert

Aufgabe 4: Die nmap Skripte sind in Kategorien eingeteilt, es gibt z.B. eine Kategorie vuln (Siehe Kategorie vuln). Verwende die Option --script=vuln um alle Skripte dieser Kategorie zu starten. Verwende als Ziel die Metasploitable VM. Dieser Scan dauert sehr lange, schränke ein auf die Ports von FTP und HTTP.

### Aufgabe 1:
Befehl:   
```
nmap -sC --top-ports 100 192.168.17.51
```

`-sC` führt die Default Lua Scripts aus   
`--top-ports 100` scannt nur die 100 häufigsten Ports  

### Aufgabe 2:
ausgewählte Skripte:   
- banner → Service-Banner auslesen
- http-title → Titel von Webseiten anzeigen
- http-headers → HTTP-Header analysieren
- ftp-anon → anonymer FTP-Login
- mysql-info → MySQL-Server-Infos

Befehl:   
```
nmap --script banner,http-title,http-headers,ftp-anon,mysql-info \
--top-ports 100 192.168.17.51
```
-> es werden nur die 5 ausgewählten Lua Scripts gestartet

### Aufgabe 3
weiteres NSE-Lua-Skript, dass auf der Metasploitable VM sinnvolle Ergebnisse liefert:     
```smb-os-discovery```   
Dieses Skript ist sinnvoll, da Metasploitable ein unsicher konfiguriertes SMB hat und das Skript System- und Versionsinformationen liefert.   

Befehl:   
```
nmap --script smb-os-discovery --top-ports 100 192.168.17.51 
```

Ausgabe:   
![](https://github.com/user-attachments/assets/6254cb67-e6e3-486a-8bd5-6499e052ff57)

### Aufgabe 4
Befehl:   
```
nmap --script=vuln -p 21,80 192.168.17.51   
```

FTP: Port 21   
HTTP: Port 80   

## Übung 3: very safe FTP backdoor
**Angabe:**   
Der vuln-scan auf Metasploitable Port 21/FTP liefert Hinweis auf eine Schwachstelle, verwende die angezeigte CVE Nummer um genaueres über diese herauszufinden.

Ausgabe, in der die CVE Nummer zu sehen ist:   
![](https://github.com/user-attachments/assets/a8c92988-3687-4ea6-a144-e5bf27e5c7bd)

CVE-Nummer 2011-2523:   
Betroffener Dienst vsFTPd 2.3.4   
In einer manipulierten Version von vsFTPd 2.3.4 wurde eine Backdoor eingebaut.   
Wenn sich ein Benutzer mit einem Benutzernamen anmeldet, der :) enthält, dann öffnet der FTP-Server automatisch einen Backdoor-Shell-Zugang auf Port 6200 mit Root-Rechten.   
Die Schwachstelle ermöglicht unauthentifizierte Remote Code Execution und ist kritisch.   


# Thema: Login Vulnerabilites
## Übung 1: rlogin vulnerability
**Angabe:**   
Informiere dich über `rlogin` und mögliche Angriffe/Fehlkonfiguration in diesem Zusammenhang.
- Prüfe mit nmap ob der rlogin zugeordnete Port bei Metasploitable offen ist.
- Nutze diese Sicherheitslücke aus um dich als root mit rlogin einzuloggen.
- Welche Fehlkonfiguration ermöglicht diesen exploit?
- Ändere die Konfiguration von Metasploitable ab um die Sicherheitslücke zu schließen.


